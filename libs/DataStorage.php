<?php/** * File based key:value data storage. * Call statically. * * Use for several Api session store * Call DataStorage::dir(TMP_DIR); before usage recommended */class DataStorage{    private static $dir = '.';    private static $file = 'stored_data.json.tmp';    private static $path;    /**     *  Set storage dir and file     *     * @param string $dir     *     * @return void     */    public static function dir($dir)    {        self::$dir = $dir;        self::$path = self::$dir . '/' . self::$file;    }    /**     *  Get stored data by key     *     * @param string $key     *     * @return string     */    public function get($key = '')    {        $json = json_decode(file_get_contents(self::$path), true);        return ($key) ? $json[$key] : $json;    }    /**     *  Set data to storage     *     * @param mixed  $data     * @param string $key     *     * @return bool     */    public function set($data = [], $key = '')    {        $allData = self::get();        if ($key) {            $allData[$key] = $data;        } else {            $allData = $data;        }        return file_put_contents(self::$path, json_encode($allData));    }    /**     *  Clean up storage     *     * @return bool     */    public function clean()    {        return self::set([]);    }}